<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add New Movie - MovieHub</title>
    <link rel="stylesheet" href="/css/add.movie.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>

<body>
    <%- include('header.ejs') %>

    <main class="add-movie-page">
        <div class="page-header">
            <div class="header-content">
                <h1>Add New Movie</h1>
                <p>Expand your movie collection with amazing content</p>
            </div>
        </div>

        <div class="form-container">
            <div class="form-card">
                <div class="form-header">
                    <div class="form-icon">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"></rect>
                            <line x1="7" y1="2" x2="7" y2="22"></line>
                            <line x1="17" y1="2" x2="17" y2="22"></line>
                            <line x1="2" y1="12" x2="22" y2="12"></line>
                            <line x1="2" y1="7" x2="7" y2="7"></line>
                            <line x1="2" y1="17" x2="7" y2="17"></line>
                            <line x1="17" y1="17" x2="22" y2="17"></line>
                            <line x1="17" y1="7" x2="22" y2="7"></line>
                        </svg>
                    </div>
                    <h2>Movie Details</h2>
                    <p>Fill in the information about your movie</p>
                </div>

                <form action="/addmoviedata" method="post" enctype="multipart/form-data" class="movie-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="title">Movie Title *</label>
                            <input type="text" id="title" name="title" placeholder="Enter movie title" required>
                            <span class="input-helper">The official title of the movie</span>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="genre">Genre *</label>
                            <select id="genre" name="genre" required>
                                <option value="">-- Select Genre --</option>
                                <option value="Action">Action</option>
                                <option value="Adventure">Adventure</option>
                                <option value="Comedy">Comedy</option>
                                <option value="Drama">Drama</option>
                                <option value="Fantasy">Fantasy</option>
                                <option value="Horror">Horror</option>
                                <option value="Mystery">Mystery</option>
                                <option value="Romance">Romance</option>
                                <option value="Sci-Fi">Sci-Fi</option>
                                <option value="Thriller">Thriller</option>
                                <option value="Documentary">Documentary</option>
                            </select>
                            <span class="input-helper">Choose the primary genre</span>
                        </div>

                        <div class="form-group">
                            <label for="year">Release Year *</label>
                            <input type="text" id="year" name="year" maxlength="4" pattern="^(18[8-9][0-9]|19[0-9]{2}|20[0-2][0-9]|2025)$" placeholder="2025" required>
                            <span class="input-helper">Year of release</span>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="rating">Rating *</label>
                            <select id="rating" name="rating" required>
                                <option value="">-- Select Rating --</option>
                                <option value="1">⭐ 1 - Poor</option>
                                <option value="2">⭐⭐ 2 - Fair</option>
                                <option value="3">⭐⭐⭐ 3 - Good</option>
                                <option value="4">⭐⭐⭐⭐ 4 - Very Good</option>
                                <option value="5">⭐⭐⭐⭐⭐ 5 - Excellent</option>
                            </select>
                            <span class="input-helper">Your personal rating</span>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="description">Description *</label>
                            <textarea id="description" name="description" rows="4" placeholder="Enter a brief description of the movie..." required></textarea>
                            <span class="input-helper">Brief plot summary or movie description</span>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="ProfileImage">Movie Poster *</label>
                            <div class="file-upload-wrapper">
                                <input type="file" id="ProfileImage" name="ProfileImage" accept="image/*" required>
                                <div class="file-upload-label">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="17 8 12 3 7 8"></polyline>
                                        <line x1="12" y1="3" x2="12" y2="15"></line>
                                    </svg>
                                    <span>Choose poster image</span>
                                </div>
                            </div>
                            <span class="input-helper">Upload a high-quality movie poster</span>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-cancel" onclick="window.history.back()">
                            Cancel
                        </button>
                        <button type="submit" class="btn-submit">
                            <span>Add Movie</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <%- include('footer.ejs') %>

    <script>
        // File upload preview functionality
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('ProfileImage');
            const fileLabel = document.querySelector('.file-upload-label');
            const fileNameSpan = fileLabel.querySelector('span');
            
            // Handle file selection
            fileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    // Update file name display
                    fileNameSpan.textContent = file.name;
                    
                    // Create image preview
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        // Remove existing preview if any
                        const existingPreview = fileLabel.querySelector('.image-preview');
                        if (existingPreview) {
                            existingPreview.remove();
                        }
                        
                        // Create preview image
                        const preview = document.createElement('div');
                        preview.className = 'image-preview';
                        preview.innerHTML = `
                            <img src="${e.target.result}" alt="Preview" />
                            <div class="preview-overlay">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h18a2 2 0 0 1 2 2z"></path>
                                    <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                                    <circle cx="13.5" cy="7.5" r="2.5"></circle>
                                </svg>
                                <span>Change Image</span>
                            </div>
                        `;
                        
                        // Clear the label content and add preview
                        fileLabel.innerHTML = '';
                        fileLabel.appendChild(preview);
                        
                        // Add click handler to preview for changing image
                        preview.addEventListener('click', function() {
                            fileInput.click();
                        });
                    };
                    reader.readAsDataURL(file);
                    
                    // Update label styling
                    fileLabel.style.borderColor = '#e50914';
                    fileLabel.style.background = 'rgba(229, 9, 20, 0.05)';
                }
            });
            
            // Handle click on the label to trigger file input
            fileLabel.addEventListener('click', function(e) {
                e.preventDefault();
                fileInput.click();
            });
            
            // Handle drag and drop
            fileLabel.addEventListener('dragover', function(e) {
                e.preventDefault();
                fileLabel.style.borderColor = '#e50914';
                fileLabel.style.background = 'rgba(229, 9, 20, 0.1)';
            });
            
            fileLabel.addEventListener('dragleave', function(e) {
                e.preventDefault();
                if (!fileLabel.querySelector('.image-preview')) {
                    fileLabel.style.borderColor = 'rgba(255, 255, 255, 0.2)';
                    fileLabel.style.background = 'rgba(42, 42, 42, 0.8)';
                }
            });
            
            fileLabel.addEventListener('drop', function(e) {
                e.preventDefault();
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    fileInput.files = files;
                    const event = new Event('change', { bubbles: true });
                    fileInput.dispatchEvent(event);
                }
            });
        });
    </script>
</body>

</html>